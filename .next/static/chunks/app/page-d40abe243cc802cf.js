(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5450:(e,t,l)=>{Promise.resolve().then(l.bind(l,5650))},5650:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>X});var a=l(5155),s=l(2596),n=l(9688);function r(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];return(0,n.QP)((0,s.$)(t))}var i=l(1700),d=l(4416),c=l(2115);let o=i.bL;i.l9;let m=i.ZL;i.bm;let u=c.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)(i.hJ,{ref:t,className:r("fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...s})});u.displayName=i.hJ.displayName;let h=c.forwardRef((e,t)=>{let{className:l,children:s,...n}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(i.UC,{ref:t,className:r("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-neutral-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full dark:border-neutral-800 dark:bg-neutral-950",l),...n,children:[s,(0,a.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-neutral-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-neutral-100 data-[state=open]:text-neutral-500 dark:ring-offset-neutral-950 dark:focus:ring-neutral-300 dark:data-[state=open]:bg-neutral-800 dark:data-[state=open]:text-neutral-400",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=i.UC.displayName;let x=e=>{let{className:t,...l}=e;return(0,a.jsx)("div",{className:r("flex flex-col space-y-1.5 text-center sm:text-left",t),...l})};x.displayName="DialogHeader";let g=c.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)(i.hE,{ref:t,className:r("text-lg font-semibold leading-none tracking-tight",l),...s})});g.displayName=i.hE.displayName,c.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,a.jsx)(i.VY,{ref:t,className:r("text-sm text-neutral-500 dark:text-neutral-400",l),...s})}).displayName=i.VY.displayName;var f=l(4992),p=l(1492),v=l(8553),j=l(4460),N=l(7265),y=l(6140),b=l(8691),w=l(2353),k=l(1284),A=l(4516),S=l(8611),C=l(5742),V=l(537),T=l(4186),L=l(5339);let _=e=>new Date(e).toLocaleString(),D=(e,t)=>{if(null==t)return"N/A";switch(e.toLowerCase()){case"altitude":case"accuracy":return"".concat(t," m");case"temperature":return"".concat(t," \xb0C");case"humidity":case"fuel":return"".concat(t," %");case"odometer":case"distance":return"".concat(t," km");case"satellites":case"hdop":default:return t.toString();case"ignition":return t?"On":"Off";case"engine":return t?"Running":"Off"}},E=e=>{switch(e.toLowerCase()){case"temperature":return(0,a.jsx)(f.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"altitude":return(0,a.jsx)(p.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"satellites":return(0,a.jsx)(v.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"fuel":return(0,a.jsx)(j.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"ignition":case"engine":return(0,a.jsx)(N.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"odometer":case"distance":return(0,a.jsx)(y.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"humidity":return(0,a.jsx)(b.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"hdop":case"accuracy":return(0,a.jsx)(w.A,{className:"h-5 w-5 mr-2 text-neutral-500"});default:return(0,a.jsx)(k.A,{className:"h-5 w-5 mr-2 text-neutral-500"})}};function F(e){let{isOpen:t,onClose:l,vehicleDetails:s,isLoading:n}=e,[r,i]=(0,c.useState)(!1);(0,c.useEffect)(()=>{t&&console.log("Vehicle details dialog opened",{isOpen:t,vehicleDetails:s,isLoading:n})},[t,s,n]);let m=s&&(null==s?void 0:s.additionalTelemetry)?Object.entries(s.additionalTelemetry).filter(e=>{let[t,l]=e;return null!=l}).sort((e,t)=>{let[l]=e,[a]=t;return l.localeCompare(a)}):[];return(0,a.jsx)(o,{open:t,onOpenChange:e=>{e||l()},children:(0,a.jsxs)(h,{className:"max-w-md max-h-[80vh] overflow-y-auto",children:[(0,a.jsx)(x,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(g,{children:s?s.name:"Vehicle Details"}),(0,a.jsx)("button",{onClick:l,className:"rounded-full p-1 hover:bg-neutral-100",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})]})}),n?(0,a.jsxs)("div",{className:"flex flex-col space-y-3 py-4",children:[(0,a.jsx)("div",{className:"h-6 bg-neutral-100 animate-pulse rounded"}),(0,a.jsx)("div",{className:"h-6 bg-neutral-100 animate-pulse rounded"}),(0,a.jsx)("div",{className:"h-6 bg-neutral-100 animate-pulse rounded"})]}):s?(0,a.jsxs)("div",{className:"flex flex-col space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(A.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Location:"}),(0,a.jsxs)("span",{className:"ml-2 text-sm",children:[s.lat.toFixed(6),", ",s.lng.toFixed(6)]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(S.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Speed:"}),(0,a.jsxs)("span",{className:"ml-2",children:[s.speed," km/h"]})]}),void 0!==s.heading&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Heading:"}),(0,a.jsxs)("span",{className:"ml-2",children:[Math.round(s.heading),"\xb0"]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(V.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Battery:"}),(0,a.jsx)("div",{className:"ml-2 w-24 bg-neutral-200 rounded-full h-2.5 dark:bg-neutral-700",children:(0,a.jsx)("div",{className:"h-2.5 rounded-full ".concat(s.battery>20?"bg-green-600":"bg-red-600"),style:{width:"".concat(s.battery,"%")}})}),(0,a.jsxs)("span",{className:"ml-2",children:[s.battery,"%"]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(T.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Last updated:"}),(0,a.jsx)("span",{className:"ml-2",children:_(s.timestamp)})]}),m.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-neutral-700",children:"Additional Telemetry"}),(0,a.jsx)("button",{onClick:()=>i(!r),className:"text-xs text-blue-600 hover:text-blue-800",children:r?"Show Less":"Show All"})]}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-2",children:[m.slice(0,r?void 0:3).map(e=>{let[t,l]=e;return(0,a.jsxs)("div",{className:"flex items-center",children:[E(t),(0,a.jsxs)("span",{className:"font-medium capitalize",children:[t.replace("_"," "),":"]}),(0,a.jsx)("span",{className:"ml-2",children:D(t,l)})]},t)}),!r&&m.length>3&&(0,a.jsxs)("div",{className:"text-xs text-center text-neutral-500",children:["+ ",m.length-3," more fields"]})]})]})]}):(0,a.jsxs)("div",{className:"flex items-center justify-center p-6",children:[(0,a.jsx)(L.A,{className:"h-6 w-6 text-red-500 mr-2"}),(0,a.jsx)("span",{children:"No vehicle data available"})]})]})})}l(8413);var z=l(5028);let O=(0,z.default)(()=>Promise.all([l.e(761),l.e(712)]).then(l.bind(l,9712)).then(e=>e.MapContainer),{loadableGenerated:{webpack:()=>[9712]},ssr:!1}),P=(0,z.default)(()=>Promise.all([l.e(761),l.e(712)]).then(l.bind(l,9712)).then(e=>e.TileLayer),{loadableGenerated:{webpack:()=>[9712]},ssr:!1}),I=(0,z.default)(()=>Promise.all([l.e(761),l.e(712)]).then(l.bind(l,9712)).then(e=>e.Marker),{loadableGenerated:{webpack:()=>[9712]},ssr:!1}),M=(0,z.default)(()=>Promise.all([l.e(761),l.e(712)]).then(l.bind(l,9712)).then(e=>e.Popup),{loadableGenerated:{webpack:()=>[9712]},ssr:!1});function R(e){let{vehicles:t,onVehicleClick:s}=e,[n,r]=(0,c.useState)(null);if((0,c.useEffect)(()=>{l.e(761).then(l.t.bind(l,5752,23)).then(e=>{r(e);let t=document.createElement("style");t.textContent="\n        .vehicle-marker {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n        .vehicle-marker img {\n          width: 32px;\n          height: 20px;\n        }\n      ",document.head.appendChild(t)})},[]),!n)return(0,a.jsx)("div",{className:"h-full w-full bg-neutral-100 animate-pulse rounded-lg"});let i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new n.DivIcon({html:'<div style="transform: rotate('.concat(e,'deg);"><img src="/icons/golf-cart.png" alt="Vehicle" /></div>'),className:"vehicle-marker",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]})};return(0,a.jsx)("div",{className:"h-[calc(100vh)] w-full rounded-lg overflow-hidden ",children:(0,a.jsxs)(O,{center:{lat:32.219143,lng:-7.936173},zoom:18,style:{height:"100%",width:"100%"},children:[(0,a.jsx)(P,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png"}),t.map(e=>{let t=e.heading||0,l=i(t);return(0,a.jsx)(I,{position:[e.lat,e.lng],icon:l,eventHandlers:{click:()=>{}},children:(0,a.jsx)(M,{children:(0,a.jsxs)("div",{className:"p-1",children:[(0,a.jsx)("div",{className:"font-bold",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["Heading: ",Math.round(t),"\xb0"]})]})})},e.id)})]})})}let G=l(3464).A.create({baseURL:"https://flespi.io",headers:{Authorization:"FlespiToken ".concat("XerK3k3u8kjS3gcwwluEcxSv7LJem1Zxn3MlB4eGd7BgENdnKzrbVTJfvx2o6m5I")}}),H=[{id:"1",name:"Truck 1",lat:32.219143,lng:-7.936173},{id:"2",name:"Truck 2",lat:35.7806,lng:-78.6452},{id:"3",name:"Van 1",lat:35.7756,lng:-78.6302},{id:"4",name:"Car 1",lat:35.7846,lng:-78.6432}],B=async()=>{try{var e,t,l,a,s,n,r,i,d,c,o,m,u,h,x,g,f,p,v,j;let N=await G.get("/gw/devices/all?fields=id,name");if(!(null==(e=N.data)?void 0:e.result)||!Array.isArray(N.data.result)||0===N.data.result.length)return H;let y=N.data.result,b=[];for(let e of y)try{let N=await G.get("/gw/devices/".concat(e.id,"/telemetry/all"));if(null==(a=N.data)||null==(l=a.result)||null==(t=l[0])?void 0:t.telemetry){let t=N.data.result[0].telemetry;if((null==(s=t.position)?void 0:s.value)||(null==(n=t["position.latitude"])?void 0:n.value)!==void 0&&(null==(r=t["position.longitude"])?void 0:r.value)!==void 0){let l=null!=(g=null!=(x=null==(i=t["position.latitude"])?void 0:i.value)?x:null==(c=t.position)||null==(d=c.value)?void 0:d.latitude)?g:0,a=null!=(p=null!=(f=null==(o=t["position.longitude"])?void 0:o.value)?f:null==(u=t.position)||null==(m=u.value)?void 0:m.longitude)?p:0,s=null!=(v=null==(h=t["position.direction"])?void 0:h.value)?v:0;l&&a&&b.push({id:String(e.id),name:e.name||(null==(j=t["device.name"])?void 0:j.value)||"Vehicle ".concat(e.id),lat:parseFloat(String(l)),lng:parseFloat(String(a)),heading:parseFloat(String(s))})}}}catch(t){console.error("Error fetching telemetry for device ".concat(e.id,":"),t)}return b.length>0?b:H}catch(e){return console.error("Error fetching vehicle positions:",e),H}},J=async e=>{try{var t,l,a,s,n,r,i,d,c,o,m,u,h,x,g,f,p,v,j;let N=await G.get("/gw/devices/".concat(e,"/telemetry/all"));if(null==(a=N.data)||null==(l=a.result)||null==(t=l[0])?void 0:t.telemetry){console.log("telemetryResponse: ",N.data.result[0].telemetry);let t=N.data.result[0].telemetry,l=(null==(s=t["device.name"])?void 0:s.value)||"Vehicle ".concat(e),a=null!=(h=null==(n=t["position.latitude"])?void 0:n.value)?h:0,y=null!=(x=null==(r=t["position.longitude"])?void 0:r.value)?x:0,b=null!=(g=null==(i=t["position.direction"])?void 0:i.value)?g:0,w=null!=(f=null==(d=t["position.speed"])?void 0:d.value)?f:0,k=null!=(p=null==(c=t["battery.level"])?void 0:c.value)?p:0,A=(null==(o=t.timestamp)?void 0:o.value)?1e3*t.timestamp.value:null!=(v=null==(u=t.server)||null==(m=u.timestamp)?void 0:m.value)?v:Date.now(),S={};for(let[e,l]of Object.entries({"position.altitude":"altitude","position.satellites":"satellites","position.hdop":"hdop","position.pdop":"pdop","battery.voltage":"battery_voltage","battery.current":"battery_current","engine.ignition.status":"ignition","gsm.signal.level":"gsm_signal","movement.status":"movement","external.powersource.voltage":"external_power","sleep.mode.enum":"sleep_mode"}))(null==(j=t[e])?void 0:j.value)!==void 0&&(S[l]=t[e].value);return{id:e,name:l,lat:a,lng:y,speed:w,battery:k,timestamp:A,heading:b,additionalTelemetry:S}}let y=(await B()).find(t=>t.id===e);if(y)return{id:y.id,name:y.name,lat:y.lat,lng:y.lng,speed:0,battery:50,timestamp:Date.now(),heading:y.heading||0,additionalTelemetry:{}};return{id:e,name:"Vehicle ".concat(e),lat:32.220923,lng:-7.929113,speed:0,battery:50,timestamp:Date.now(),heading:0,additionalTelemetry:{}}}catch(l){console.error("Error fetching vehicle details:",l);let t=(await B()).find(t=>t.id===e);if(t)return{id:t.id,name:t.name,lat:t.lat,lng:t.lng,speed:0,battery:50,timestamp:Date.now(),heading:t.heading||0,additionalTelemetry:{}};return{id:e,name:"Vehicle ".concat(e),lat:32.220923,lng:-7.929113,speed:0,battery:50,timestamp:Date.now(),heading:0,additionalTelemetry:{}}}};var U=l(6474),K=l(7930),Y=l(9267),Z=l(1539);function Q(e){var t,l;let{vehicles:s,selectedVehicleId:n,onVehicleClick:r,isLoading:i}=e,[d,o]=(0,c.useState)(null),[m,u]=(0,c.useState)(null),[h,x]=(0,c.useState)(!1),g=async e=>{let t=e.target.value;t?(o(t),await f(t)):(o(null),u(null))},f=async e=>{if(e){x(!0);try{let t=await J(e);u(t),console.log("Sidebar vehicle details fetched:",t)}catch(e){console.error("Failed to fetch sidebar vehicle details:",e)}finally{x(!1)}}};return(0,c.useEffect)(()=>{if(!d)return;f(d);let e=setInterval(()=>{f(d)},5e3);return()=>clearInterval(e)},[d]),(0,a.jsxs)("div",{className:"p-4 h-full overflow-auto flex flex-col",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Vehicle Details"})}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"vehicleSelector",className:"block text-sm font-medium text-gray-100 mb-1",children:"Select Vehicle"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("select",{id:"vehicleSelector",className:"block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:d||"",onChange:g,children:[(0,a.jsx)("option",{value:"",children:"Select a vehicle..."}),s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:(0,a.jsx)(U.A,{className:"h-4 w-4"})})]})]}),m?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-blue-500",children:(0,a.jsxs)("div",{className:"items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center text-black",children:[(0,a.jsx)(K.A,{className:"h-6 w-6 mr-3"}),(0,a.jsx)("h3",{className:"font-bold text-lg",children:m.name})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,a.jsx)(T.A,{className:"h-3 w-3 mr-1"}),(0,a.jsx)("span",{children:new Date(m.timestamp).toLocaleTimeString()})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-2 text-blue-500"}),"Location"]}),(0,a.jsxs)("div",{className:"text-gray-800 font-medium",children:[m.lat.toFixed(6),","," ",m.lng.toFixed(6)]}),void 0!==m.heading&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-600 flex items-center",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 mr-1 text-gray-500"}),(0,a.jsxs)("span",{children:["Heading: ",Math.round(m.heading),"\xb0"]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,a.jsx)(S.A,{className:"h-4 w-4 mr-2 text-blue-500"}),"Speed"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:m.speed}),(0,a.jsx)("div",{className:"ml-2 text-sm text-gray-600",children:"km/h"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,a.jsx)(V.A,{className:"h-4 w-4 mr-2 text-blue-500"}),"Battery Status"]}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,a.jsx)("div",{className:"h-2.5 rounded-full ".concat(m.battery>50?"bg-green-500":m.battery>20?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(m.battery,"%")}})}),(0,a.jsxs)("span",{className:"ml-2 text-sm font-medium text-gray-900",children:[m.battery,"%"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(null==(t=m.additionalTelemetry)?void 0:t.battery_voltage)!==void 0&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 flex items-center",children:[(0,a.jsx)(Y.A,{className:"h-3 w-3 mr-1 text-gray-500"}),(0,a.jsxs)("span",{children:[m.additionalTelemetry.battery_voltage," ","V"]})]}),(null==(l=m.additionalTelemetry)?void 0:l.battery_current)!==void 0&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 flex items-center",children:[(0,a.jsx)(Z.A,{className:"h-3 w-3 mr-1 text-gray-500"}),(0,a.jsxs)("span",{children:[m.additionalTelemetry.battery_current," ","A"]})]})]})]})]}):d?(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[(0,a.jsx)(K.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Loading vehicle data..."})]}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[(0,a.jsx)(K.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Please select a vehicle to view details"})]})]})}function X(){let[e,t]=(0,c.useState)([]),[l,s]=(0,c.useState)(!0),[n,r]=(0,c.useState)(null),i=(0,c.useRef)({}),[d,o]=(0,c.useState)(!1),[m,u]=(0,c.useState)(null),[h,x]=(0,c.useState)(null),[g,f]=(0,c.useState)(!1),p=(e,t,l,a)=>e===l&&t===a?0:(180/Math.PI*Math.atan2(a-t,l-e)+360)%360;(0,c.useEffect)(()=>{let e=async()=>{try{s(!0),r(null);let e=(await B()).map(e=>{let t=i.current[e.id],l=e.heading||0;return t&&(t.lat!==e.lat||t.lng!==e.lng)&&(l=p(t.lat,t.lng,e.lat,e.lng)),i.current[e.id]={lat:e.lat,lng:e.lng},{...e,heading:l}});t(e)}catch(e){console.error("Failed to fetch vehicles:",e),r("Failed to load vehicles. Please try again later.")}finally{s(!1)}};e();let l=setInterval(e,2e3);return()=>clearInterval(l)},[]);let v=async e=>{console.log("Dashboard: handleVehicleClick called with ID:",e),o(!0),u(e),f(!0);try{let t=await J(e);console.log("Dashboard: Vehicle details fetched:",t),x(t)}catch(e){console.error("Failed to fetch vehicle details:",e)}finally{f(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,a.jsxs)("main",{className:"flex-1 flex flex-col md:flex-row",children:[(0,a.jsx)("div",{className:"w-full md:w-80 ",children:(0,a.jsx)(Q,{vehicles:e,selectedVehicleId:m,onVehicleClick:v,isLoading:l})}),(0,a.jsx)("div",{className:"flex-1 p-4",children:l&&!e.length?(0,a.jsx)("div",{className:"h-[calc(100vh-140px)] w-full bg-neutral-100 animate-pulse rounded-lg"}):n?(0,a.jsx)("div",{className:"h-[calc(100vh-140px)] w-full flex items-center justify-center border border-red-200 bg-red-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-red-500",children:n})}):0===e.length?(0,a.jsx)("div",{className:"h-[calc(100vh-140px)] w-full flex items-center justify-center border border-neutral-200 bg-neutral-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-neutral-500",children:"No vehicles found"})}):(0,a.jsx)(R,{vehicles:e,onVehicleClick:v})})]}),(0,a.jsx)(F,{isOpen:d,onClose:()=>{o(!1),x(null)},vehicleDetails:h,isLoading:g})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[484,877,441,684,358],()=>t(5450)),_N_E=e.O()}]);