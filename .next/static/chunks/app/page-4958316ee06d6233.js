(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5450:(e,t,a)=>{Promise.resolve().then(a.bind(a,5650))},5650:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>X});var l=a(5155),s=a(2596),n=a(9688);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,s.$)(t))}var r=a(1700),d=a(4416),c=a(2115);let o=r.bL;r.l9;let m=r.ZL;r.bm;let u=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.hJ,{ref:t,className:i("fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});u.displayName=r.hJ.displayName;let h=c.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,l.jsxs)(m,{children:[(0,l.jsx)(u,{}),(0,l.jsxs)(r.UC,{ref:t,className:i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-neutral-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full dark:border-neutral-800 dark:bg-neutral-950",a),...n,children:[s,(0,l.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-neutral-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-neutral-100 data-[state=open]:text-neutral-500 dark:ring-offset-neutral-950 dark:focus:ring-neutral-300 dark:data-[state=open]:bg-neutral-800 dark:data-[state=open]:text-neutral-400",children:[(0,l.jsx)(d.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=r.UC.displayName;let x=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:i("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};x.displayName="DialogHeader";let g=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.hE,{ref:t,className:i("text-lg font-semibold leading-none tracking-tight",a),...s})});g.displayName=r.hE.displayName,c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.VY,{ref:t,className:i("text-sm text-neutral-500 dark:text-neutral-400",a),...s})}).displayName=r.VY.displayName;var f=a(4992),p=a(1492),v=a(8553),j=a(4460),N=a(7265),b=a(6140),y=a(8691),w=a(2353),k=a(1284),A=a(4516),S=a(8611),C=a(5742),_=a(537),M=a(4186),V=a(5339);let E=e=>new Date(e).toLocaleString(),T=(e,t)=>{if(null==t)return"N/A";switch(e.toLowerCase()){case"altitude":case"accuracy":return"".concat(t," m");case"temperature":return"".concat(t," \xb0C");case"humidity":case"fuel":return"".concat(t," %");case"odometer":case"distance":return"".concat(t," km");case"satellites":case"hdop":default:return t.toString();case"ignition":return t?"On":"Off";case"engine":return t?"Running":"Off"}},D=e=>{switch(e.toLowerCase()){case"temperature":return(0,l.jsx)(f.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"altitude":return(0,l.jsx)(p.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"satellites":return(0,l.jsx)(v.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"fuel":return(0,l.jsx)(j.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"ignition":case"engine":return(0,l.jsx)(N.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"odometer":case"distance":return(0,l.jsx)(b.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"humidity":return(0,l.jsx)(y.A,{className:"h-5 w-5 mr-2 text-neutral-500"});case"hdop":case"accuracy":return(0,l.jsx)(w.A,{className:"h-5 w-5 mr-2 text-neutral-500"});default:return(0,l.jsx)(k.A,{className:"h-5 w-5 mr-2 text-neutral-500"})}};function L(e){let{isOpen:t,onClose:a,vehicleDetails:s,isLoading:n}=e,[i,r]=(0,c.useState)(!1);(0,c.useEffect)(()=>{t&&console.log("Vehicle details dialog opened",{isOpen:t,vehicleDetails:s,isLoading:n})},[t,s,n]);let m=s&&(null==s?void 0:s.additionalTelemetry)?Object.entries(s.additionalTelemetry).filter(e=>{let[t,a]=e;return null!=a}).sort((e,t)=>{let[a]=e,[l]=t;return a.localeCompare(l)}):[];return(0,l.jsx)(o,{open:t,onOpenChange:e=>{e||a()},children:(0,l.jsxs)(h,{className:"max-w-md max-h-[80vh] overflow-y-auto",children:[(0,l.jsx)(x,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(g,{children:s?s.name:"Vehicle Details"}),(0,l.jsx)("button",{onClick:a,className:"rounded-full p-1 hover:bg-neutral-100",children:(0,l.jsx)(d.A,{className:"h-4 w-4"})})]})}),n?(0,l.jsxs)("div",{className:"flex flex-col space-y-3 py-4",children:[(0,l.jsx)("div",{className:"h-6 bg-neutral-100 animate-pulse rounded"}),(0,l.jsx)("div",{className:"h-6 bg-neutral-100 animate-pulse rounded"}),(0,l.jsx)("div",{className:"h-6 bg-neutral-100 animate-pulse rounded"})]}):s?(0,l.jsxs)("div",{className:"flex flex-col space-y-4 py-4",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(A.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,l.jsx)("span",{className:"font-medium",children:"Location:"}),(0,l.jsxs)("span",{className:"ml-2 text-sm",children:[s.lat.toFixed(6),", ",s.lng.toFixed(6)]})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(S.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,l.jsx)("span",{className:"font-medium",children:"Speed:"}),(0,l.jsxs)("span",{className:"ml-2",children:[s.speed," km/h"]})]}),void 0!==s.heading&&(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(C.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,l.jsx)("span",{className:"font-medium",children:"Heading:"}),(0,l.jsxs)("span",{className:"ml-2",children:[Math.round(s.heading),"\xb0"]})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(_.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,l.jsx)("span",{className:"font-medium",children:"Battery:"}),(0,l.jsx)("div",{className:"ml-2 w-24 bg-neutral-200 rounded-full h-2.5 dark:bg-neutral-700",children:(0,l.jsx)("div",{className:"h-2.5 rounded-full ".concat(s.battery>20?"bg-green-600":"bg-red-600"),style:{width:"".concat(s.battery,"%")}})}),(0,l.jsxs)("span",{className:"ml-2",children:[s.battery,"%"]})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(M.A,{className:"h-5 w-5 mr-2 text-neutral-500"}),(0,l.jsx)("span",{className:"font-medium",children:"Last updated:"}),(0,l.jsx)("span",{className:"ml-2",children:E(s.timestamp)})]}),m.length>0&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-neutral-700",children:"Additional Telemetry"}),(0,l.jsx)("button",{onClick:()=>r(!i),className:"text-xs text-blue-600 hover:text-blue-800",children:i?"Show Less":"Show All"})]}),(0,l.jsxs)("div",{className:"space-y-2 border-t pt-2",children:[m.slice(0,i?void 0:3).map(e=>{let[t,a]=e;return(0,l.jsxs)("div",{className:"flex items-center",children:[D(t),(0,l.jsxs)("span",{className:"font-medium capitalize",children:[t.replace("_"," "),":"]}),(0,l.jsx)("span",{className:"ml-2",children:T(t,a)})]},t)}),!i&&m.length>3&&(0,l.jsxs)("div",{className:"text-xs text-center text-neutral-500",children:["+ ",m.length-3," more fields"]})]})]})]}):(0,l.jsxs)("div",{className:"flex items-center justify-center p-6",children:[(0,l.jsx)(V.A,{className:"h-6 w-6 text-red-500 mr-2"}),(0,l.jsx)("span",{children:"No vehicle data available"})]})]})})}a(8413);var P=a(5028);let F=(0,P.default)(()=>Promise.all([a.e(761),a.e(712)]).then(a.bind(a,9712)).then(e=>e.MapContainer),{loadableGenerated:{webpack:()=>[9712]},ssr:!1}),G=(0,P.default)(()=>Promise.all([a.e(761),a.e(712)]).then(a.bind(a,9712)).then(e=>e.TileLayer),{loadableGenerated:{webpack:()=>[9712]},ssr:!1}),z=(0,P.default)(()=>Promise.all([a.e(761),a.e(712)]).then(a.bind(a,9712)).then(e=>e.Marker),{loadableGenerated:{webpack:()=>[9712]},ssr:!1}),O=(0,P.default)(()=>Promise.all([a.e(761),a.e(712)]).then(a.bind(a,9712)).then(e=>e.Popup),{loadableGenerated:{webpack:()=>[9712]},ssr:!1});function I(e){let{vehicles:t,onVehicleClick:s}=e,n=t.length>0?{lat:t[0].lat,lng:t[0].lng}:{lat:32.219143,lng:-7.936173},[i,r]=(0,c.useState)(null);if((0,c.useEffect)(()=>{a.e(761).then(a.t.bind(a,5752,23)).then(e=>{r(e);let t=document.createElement("style");t.textContent="\n        .vehicle-marker {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n        .vehicle-marker img {\n          width: 32px;\n          height: 20px;\n        }\n      ",document.head.appendChild(t)})},[]),!i)return(0,l.jsx)("div",{className:"h-full w-full bg-neutral-100 animate-pulse rounded-lg"});let d=e=>e.startsWith("static"),o=e=>{let t=e.heading||0,a=d(e.id);return new i.DivIcon({html:'<div style="transform: rotate('.concat(t,'deg);"><img src="').concat(a?"/icons/golf-cart.png":"/icons/golf-cart-3.png",'" alt="Vehicle" /></div>'),className:"vehicle-marker",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]})};return(0,l.jsx)("div",{className:"h-[calc(100vh-30px)] w-full rounded-lg overflow-hidden ",children:(0,l.jsxs)(F,{center:n,zoom:18,style:{height:"100%",width:"100%"},children:[(0,l.jsx)(G,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png"}),t.map(e=>{let t=o(e),a=d(e.id);return(0,l.jsx)(z,{position:[e.lat,e.lng],icon:t,eventHandlers:{click:()=>{}},children:(0,l.jsx)(O,{children:(0,l.jsxs)("div",{className:"p-1",children:[(0,l.jsx)("div",{className:"font-bold",children:e.name}),(0,l.jsxs)("div",{className:"text-xs text-gray-600",children:["Heading: ",Math.round(e.heading||0),"\xb0"]}),a&&(0,l.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"Static Vehicle"})]})})},e.id)})]})})}let R=a(3464).A.create({baseURL:"https://flespi.io",headers:{Authorization:"FlespiToken ".concat("XerK3k3u8kjS3gcwwluEcxSv7LJem1Zxn3MlB4eGd7BgENdnKzrbVTJfvx2o6m5I")}}),H=[{id:"1",name:"Truck 1",lat:32.219143,lng:-7.936173},{id:"2",name:"Truck 2",lat:35.7806,lng:-78.6452},{id:"3",name:"Van 1",lat:35.7756,lng:-78.6302},{id:"4",name:"Car 1",lat:35.7846,lng:-78.6432}],B=[{id:"static1",name:"Golfette_GEP 02",lat:32.218543,lng:-7.937073,heading:140},{id:"static2",name:"Golfette_GEP 03",lat:32.219243,lng:-7.935573,heading:140},{id:"static3",name:"Golfette_GEP 04",lat:32.218851,lng:-7.937073,heading:140},{id:"static4",name:"Golfette_GEP 05",lat:32.219851,lng:-7.937073,heading:140}],J=async()=>{try{var e,t,a,l,s,n,i,r,d,c,o,m,u,h,x,g,f,p,v,j;let N=await R.get("/gw/devices/all?fields=id,name");if(!(null==(e=N.data)?void 0:e.result)||!Array.isArray(N.data.result)||0===N.data.result.length)return[...H,...B];let b=N.data.result,y=[];for(let e of b)try{let N=await R.get("/gw/devices/".concat(e.id,"/telemetry/all"));if(null==(l=N.data)||null==(a=l.result)||null==(t=a[0])?void 0:t.telemetry){let t=N.data.result[0].telemetry;if((null==(s=t.position)?void 0:s.value)||(null==(n=t["position.latitude"])?void 0:n.value)!==void 0&&(null==(i=t["position.longitude"])?void 0:i.value)!==void 0){let a=null!=(g=null!=(x=null==(r=t["position.latitude"])?void 0:r.value)?x:null==(c=t.position)||null==(d=c.value)?void 0:d.latitude)?g:0,l=null!=(p=null!=(f=null==(o=t["position.longitude"])?void 0:o.value)?f:null==(u=t.position)||null==(m=u.value)?void 0:m.longitude)?p:0,s=null!=(v=null==(h=t["position.direction"])?void 0:h.value)?v:0;a&&l&&y.push({id:String(e.id),name:e.name||(null==(j=t["device.name"])?void 0:j.value)||"Vehicle ".concat(e.id),lat:parseFloat(String(a)),lng:parseFloat(String(l)),heading:parseFloat(String(s))})}}}catch(t){console.error("Error fetching telemetry for device ".concat(e.id,":"),t)}return[...y.length>0?y:H,...B]}catch(e){return console.error("Error fetching vehicle positions:",e),[...H,...B]}},U=async e=>{let t=B.find(t=>t.id===e);if(t)return{id:t.id,name:t.name,lat:t.lat,lng:t.lng,speed:Math.floor(25*Math.random()),battery:75+Math.floor(25*Math.random()),timestamp:Date.now(),heading:t.heading||0,additionalTelemetry:{altitude:100+Math.floor(50*Math.random()),satellites:8+Math.floor(4*Math.random()),gsm_signal:80+Math.floor(20*Math.random()),movement:Math.random()>.3?"moving":"stationary"}};try{var a,l,s,n,i,r,d,c,o,m,u,h,x,g,f,p,v,j,N;let t=await R.get("/gw/devices/".concat(e,"/telemetry/all"));if(null==(s=t.data)||null==(l=s.result)||null==(a=l[0])?void 0:a.telemetry){let a=t.data.result[0].telemetry,l=(null==(n=a["device.name"])?void 0:n.value)||"Vehicle ".concat(e),s=null!=(x=null==(i=a["position.latitude"])?void 0:i.value)?x:0,b=null!=(g=null==(r=a["position.longitude"])?void 0:r.value)?g:0,y=null!=(f=null==(d=a["position.direction"])?void 0:d.value)?f:0,w=null!=(p=null==(c=a["position.speed"])?void 0:c.value)?p:0,k=null!=(v=null==(o=a["battery.level"])?void 0:o.value)?v:0,A=(null==(m=a.timestamp)?void 0:m.value)?1e3*a.timestamp.value:null!=(j=null==(h=a.server)||null==(u=h.timestamp)?void 0:u.value)?j:Date.now(),S={};for(let[e,t]of Object.entries({"position.altitude":"altitude","position.satellites":"satellites","position.hdop":"hdop","position.pdop":"pdop","battery.voltage":"battery_voltage","battery.current":"battery_current","engine.ignition.status":"ignition","gsm.signal.level":"gsm_signal","movement.status":"movement","external.powersource.voltage":"external_power","sleep.mode.enum":"sleep_mode"}))(null==(N=a[e])?void 0:N.value)!==void 0&&(S[t]=a[e].value);return{id:e,name:l,lat:s,lng:b,speed:w,battery:k,timestamp:A,heading:y,additionalTelemetry:S}}let b=(await J()).find(t=>t.id===e);if(b)return{id:b.id,name:b.name,lat:b.lat,lng:b.lng,speed:0,battery:50,timestamp:Date.now(),heading:b.heading||0,additionalTelemetry:{}};return{id:e,name:"Vehicle ".concat(e),lat:32.220923,lng:-7.929113,speed:0,battery:50,timestamp:Date.now(),heading:0,additionalTelemetry:{}}}catch(a){console.error("Error fetching vehicle details:",a);let t=(await J()).find(t=>t.id===e);if(t)return{id:t.id,name:t.name,lat:t.lat,lng:t.lng,speed:0,battery:50,timestamp:Date.now(),heading:t.heading||0,additionalTelemetry:{}};return{id:e,name:"Vehicle ".concat(e),lat:32.220923,lng:-7.929113,speed:0,battery:50,timestamp:Date.now(),heading:0,additionalTelemetry:{}}}};var K=a(6474),Y=a(7930),Z=a(9267),Q=a(1539);function W(e){var t,a;let{vehicles:s,selectedVehicleId:n,onVehicleClick:i,isLoading:r}=e,[d,o]=(0,c.useState)(null),[m,u]=(0,c.useState)(null),[h,x]=(0,c.useState)(!1),g=async e=>{let t=e.target.value;t?(o(t),await f(t)):(o(null),u(null))},f=async e=>{if(e){x(!0);try{let t=await U(e);u(t),console.log("Sidebar vehicle details fetched:",t)}catch(e){console.error("Failed to fetch sidebar vehicle details:",e)}finally{x(!1)}}};return(0,c.useEffect)(()=>{if(!d)return;f(d);let e=setInterval(()=>{f(d)},1e4);return()=>clearInterval(e)},[d]),(0,l.jsxs)("div",{className:"p-4 h-full overflow-auto flex flex-col",children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,l.jsx)("h2",{className:"text-lg text-white font-semibold",children:"Vehicle Details"})}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"vehicleSelector",className:"block text-sm font-medium text-gray-100 mb-1",children:"Select Vehicle"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{id:"vehicleSelector",className:"block w-full pl-3 pr-10 py-2 text-base border border-gray-300 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:d||"",onChange:g,children:[(0,l.jsx)("option",{value:"",children:"Select a vehicle..."}),s.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,l.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:(0,l.jsx)(K.A,{className:"h-4 w-4"})})]})]}),m?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-blue-500",children:(0,l.jsxs)("div",{className:"items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center text-black",children:[(0,l.jsx)(Y.A,{className:"h-6 w-6 mr-3"}),(0,l.jsx)("h3",{className:"font-bold text-lg",children:m.name})]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,l.jsx)(M.A,{className:"h-3 w-3 mr-1"}),(0,l.jsx)("span",{children:new Date(m.timestamp).toLocaleTimeString()})]})]})}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,l.jsx)(A.A,{className:"h-4 w-4 mr-2 text-blue-500"}),"Location"]}),(0,l.jsxs)("div",{className:"text-gray-800 font-medium",children:[m.lat.toFixed(6),","," ",m.lng.toFixed(6)]}),void 0!==m.heading&&(0,l.jsxs)("div",{className:"mt-2 text-sm text-gray-600 flex items-center",children:[(0,l.jsx)(C.A,{className:"h-4 w-4 mr-1 text-gray-500"}),(0,l.jsxs)("span",{children:["Heading: ",Math.round(m.heading),"\xb0"]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,l.jsx)(S.A,{className:"h-4 w-4 mr-2 text-blue-500"}),"Speed"]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:m.speed}),(0,l.jsx)("div",{className:"ml-2 text-sm text-gray-600",children:"km/h"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,l.jsx)(_.A,{className:"h-4 w-4 mr-2 text-blue-500"}),"Battery Status"]}),(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,l.jsx)("div",{className:"h-2.5 rounded-full ".concat(m.battery>50?"bg-green-500":m.battery>20?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(m.battery,"%")}})}),(0,l.jsxs)("span",{className:"ml-2 text-sm font-medium text-gray-900",children:[m.battery,"%"]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(null==(t=m.additionalTelemetry)?void 0:t.battery_voltage)!==void 0&&(0,l.jsxs)("div",{className:"text-sm text-gray-600 flex items-center",children:[(0,l.jsx)(Z.A,{className:"h-3 w-3 mr-1 text-gray-500"}),(0,l.jsxs)("span",{children:[m.additionalTelemetry.battery_voltage," ","V"]})]}),(null==(a=m.additionalTelemetry)?void 0:a.battery_current)!==void 0&&(0,l.jsxs)("div",{className:"text-sm text-gray-600 flex items-center",children:[(0,l.jsx)(Q.A,{className:"h-3 w-3 mr-1 text-gray-500"}),(0,l.jsxs)("span",{children:[m.additionalTelemetry.battery_current," ","A"]})]})]})]})]}):d?(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[(0,l.jsx)(Y.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),(0,l.jsx)("p",{className:"text-gray-500",children:"Loading vehicle data..."})]}):(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[(0,l.jsx)(Y.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),(0,l.jsx)("p",{className:"text-gray-500",children:"Please select a vehicle to view details"})]})]})}function X(){let[e,t]=(0,c.useState)([]),[a,s]=(0,c.useState)(!0),[n,i]=(0,c.useState)(null),r=(0,c.useRef)({}),[d,o]=(0,c.useState)(!1),[m,u]=(0,c.useState)(null),[h,x]=(0,c.useState)(null),[g,f]=(0,c.useState)(!1),p=(e,t,a,l)=>e===a&&t===l?0:(180/Math.PI*Math.atan2(l-t,a-e)+360)%360;(0,c.useEffect)(()=>{let e=async()=>{try{s(!0),i(null);let e=(await J()).map(e=>{let t=r.current[e.id],a=e.heading||0;return t&&(t.lat!==e.lat||t.lng!==e.lng)&&(a=p(t.lat,t.lng,e.lat,e.lng)),r.current[e.id]={lat:e.lat,lng:e.lng},{...e,heading:a}});t(e)}catch(e){console.error("Failed to fetch vehicles:",e),i("Failed to load vehicles. Please try again later.")}finally{s(!1)}};e();let a=setInterval(e,1e4);return()=>clearInterval(a)},[]);let v=async e=>{console.log("Dashboard: handleVehicleClick called with ID:",e),o(!0),u(e),f(!0);try{let t=await U(e);console.log("Dashboard: Vehicle details fetched:",t),x(t)}catch(e){console.error("Failed to fetch vehicle details:",e)}finally{f(!1)}};return(0,l.jsxs)("div",{className:"flex flex-col min-h-screen bg-black",children:[(0,l.jsxs)("main",{className:"flex-1 flex flex-col md:flex-row",children:[(0,l.jsx)("div",{className:"w-full md:w-80 ",children:(0,l.jsx)(W,{vehicles:e,selectedVehicleId:m,onVehicleClick:v,isLoading:a})}),(0,l.jsx)("div",{className:"flex-1 p-4",children:a&&!e.length?(0,l.jsx)("div",{className:"h-[calc(100vh-140px)] w-full bg-neutral-100 animate-pulse rounded-lg"}):n?(0,l.jsx)("div",{className:"h-[calc(100vh-140px)] w-full flex items-center justify-center border border-red-200 bg-red-50 rounded-lg",children:(0,l.jsx)("p",{className:"text-red-500",children:n})}):0===e.length?(0,l.jsx)("div",{className:"h-[calc(100vh-140px)] w-full flex items-center justify-center border border-neutral-200 bg-neutral-50 rounded-lg",children:(0,l.jsx)("p",{className:"text-neutral-500",children:"No vehicles found"})}):(0,l.jsx)(I,{vehicles:e,onVehicleClick:v})})]}),(0,l.jsx)(L,{isOpen:d,onClose:()=>{o(!1),x(null)},vehicleDetails:h,isLoading:g})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[484,877,441,684,358],()=>t(5450)),_N_E=e.O()}]);